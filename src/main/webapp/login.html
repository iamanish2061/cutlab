<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Form</title>
    <link rel="stylesheet" href="css/LoginAndSignup.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&family=Playfair+Display:wght@700&family=Nunito:wght@300;400;700&display=swap" rel="stylesheet">
  
    <!-- jQuery and jQuery UI (CDN) -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    
</head>
<body>
		
    <div class="container">
        <div class="form-container">
            <!-- Login Form -->
            <div class="form-section login-section">
              <form id="login-form" method="post" action="/cutlab/LoginProcess">
                <h2>Login</h2>
                <div class="input-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="login-email" autocomplete="username" value="" required> 
                </div>
                <div class="input-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="login-password" autocomplete="current-password" required>
                    <img class="eye-icon" src="images/eye.png" alt="" onmouseover="passwordToggleShowHide('login','in')" onmouseout="passwordToggleShowHide('login','out')">
                </div>

                <div class="login-error-msg" id="login-error-msg">  </div>  
                <div class="forgot-password">
                    <a href="forgotPassword.html">Forgot Password?</a>
                </div>
                <button type="submit" class="btn">Log In</button>
              </form>
            </div>

            <!-- Signup Form -->
            <div class="form-section signup-section">
              <form id="signup-form" method="post" action="/cutlab/SignupProcess">
                <h2>Create Account</h2>
                <div class="email-part" id="email-part">
                  <div class="input-group">
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" name="signup-email" autocomplete="email" oninput="validateEmail('signup-email')" required>
                  </div>
                  <div><a id="sendCode" style="display:none;">Send Code</a></div>
                  <div class="verificationCode" id="verificationCode" style="display:none;">
                      <div class="input-group">
                          <label for="random-generated-code">Enter code</label>
                            <input type="text" id="random-generated-code" name="random-generated-code" oninput="showNextButton('next')" required>
                      </div>
                  </div>
          
                  <div class="signup-error-msg" id="email-signup-error-msg"></div>
                  <br>
                  <div class="incomplete-content next">
                    <h4 id="email-page-next" style="display:none;">Next &gt; </h4>
                  </div>
                </div>
                             
                <div class="password-part" id="password-part" style="display: none;">
                  <div class="input-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" name="signup-password" autocomplete="new-password" oninput="validatePassword('validate')" required>
                    <img class="eye-icon" src="images/eye.png" alt="" onmouseover="passwordToggleShowHide('signup','in')" onmouseout="passwordToggleShowHide('signup','out')">
                  </div>
                  <div class="input-group">
                    <label for="signup-confirm">Confirm Password</label>
                    <input type="password" id="signup-confirm" name="signup-confirm" autocomplete="new-password" oninput="validatePassword('confirm')" required>
                    <img class="eye-icon" src="images/eye.png" alt="" onmouseover="passwordToggleShowHide('confirm','in')" onmouseout="passwordToggleShowHide('confirm','out')">
                  </div>
              
                  <div class="signup-error-msg" id="password-signup-error-msg"></div>
                  <div class="incomplete-content prev">
                    <h4 onclick="toggleContentOfSignupForm('password-part')"> &lt; Prev</h4>
                  </div>
                  <br>
                  <button type="submit" class="btn" id="signup-btn">Sign Up</button>
                </div>
              </form>
            </div>

            <!-- Overlay -->
            <div class="overlay-container">
                <div class="overlay">
                  <div class="overlay-panel overlay-left">  <!-- yo div maa photo halna milxa -->
                    <h2>Welcome!</h2>
                    <p>Already have an account? Login to continue your journey with us.</p>
                    <button class="btn ghost" id="login">Login</button>
                  </div>

                  <div class="overlay-panel overlay-right">
                    <h2>Hello, Friend!</h2>
                    <p>Don't have an account? Sign up and start your journey with us.</p>
                    <button class="btn ghost" id="signup">Sign Up</button>
                  </div>
                </div>
            </div>

        </div>
    </div>

    
    <script src="js/LoginAndSignup.js"></script>
    

    <script>
    
    $(document).ready(function() {
      $("#signup-dob").datepicker({
    	  dateFormat: "mm-dd-yy",
          changeMonth: true,
          changeYear: true,
          minDate: new Date(1900, 0, 1),
          maxDate: "+0Y"
      });
    });
  

    $(document).ready(function() {
    	
    	//to send code to gmail account
      $('#sendCode').click(function(e) {
    	$('#sendCode').hide();
        e.preventDefault();
        const email = $('#signup-email').val();
        
        $.ajax({
          url: '/cutlab/SendEmail',
          type: 'POST',
          data: { email: email },
          success: function(response) {
        	  if(response.status == 'success'){
        		  $('#verificationCode').show();
                  $('#email-signup-error-msg').text('Verification code sent!').css('color', 'green');
        	  }else{
        		  $('#email-signup-error-msg').text(response.message).css('color', 'red');
                  $('#sendCode').show();
        	  }
          },
          error: function(xhr) {
            $('#email-signup-error-msg').text('Failed to send code. Please try again.').css('color', 'red');
            $('#sendCode').show();
          }
        });
      });
      
      //to verify number
      $('#first-page-next').click(function(e){
    	  e.preventDefault();
    	  const phoneNumber = $('#signup-number').val();
    	  
    	  $.ajax({
    		 url: '/cutlab/VerifyNumber',
    		 type: 'POST',
    		 data: 	{ 
    			 		number: phoneNumber 
    			 	},
    		success: function(response){
	    		if(response.status == 'success'){
	              $('#first-signup-error-msg').text('Number is valid... Please wait!').css('color', 'green');
	              
	              setTimeout(() => {
	            	  toggleContentOfSignupForm('first');
	              }, 1500);
	              
	       	  	}else{
	       		  $('#first-signup-error-msg').text(response.message).css('color', 'red');
	       	  	}
    		},
    		error: function(xhr){
    			$('#first-signup-error-msg').text('Failed to check number. Please try again.').css('color', 'red');
    		}
    	  });
      });
      
      /* to verify email's code */
      $("#email-page-next").click(function(e){
    	  e.preventDefault();
    	  const code = $('#random-generated-code').val();
    	  const email = $('#signup-email').val();
    	  
    	  $.ajax({
    		 url: '/cutlab/VerifyEmail',
    		 type: 'POST',
    		 data: 	{ 
    			 		code: code,
    			 		email: email
    			 	},
    		success: function(response){
	    		if(response.status == 'success'){
	              $('#email-signup-error-msg').text('Verification code matched.. Please wait!').css('color', 'green');
	              
	              setTimeout(() => {
	            	  toggleContentOfSignupForm('email-page');
	            	  $("#email-signup-error-msg").text('');
	              }, 1500);
	              
	       	  	}else{
	       		  $('#email-signup-error-msg').text(response.message).css('color', 'red');
	       	  	}
    		},
    		error: function(xhr){
    			$('#email-signup-error-msg').text('Failed to check code. Please try again.').css('color', 'red');
    		}
    	  });
      });
      
    });

    
    $(document).ready(function(){
    	if(window.location.href == 'http://localhost:8080/cutlab/login.html?error=invalidEmail'){
    		$('#login-error-msg').text("Invalid Credential").css('color','red');
    	}else if(window.location.href == 'http://localhost:8080/cutlab/login.html?error=password'){
    		$('#login-error-msg').text("Email and Password doesnot match!").css('color','red');
    	}else{
    		
    	}
    });
    
    </script>
    
    
</body>
</html>
